(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Squarified"],{1369:function(t,i,e){"use strict";e.r(i);var h=function(){var t=this,i=t._self._c;return i("div",[i("div",{staticStyle:{height:"40px","line-height":"40px"}},[i("el-button",{attrs:{size:"mini"},on:{click:t.random}},[t._v("随机")])],1),i("div",{ref:"container",staticClass:"squarified-container",staticStyle:{height:"calc(100% - 40px)"}},t._l(t.squarifiedRectInfo,(function(e,h){return i("div",{key:h,style:{left:e.x+"px",top:e.y+"px",width:e.width+"px",height:e.height+"px",background:t.colors[h%t.colors.length]}},[t._v("权重："+t._s(e.data.value))])})),0)])},s=[];e("14d9"),e("13d5");class a{constructor(t,i){this.sourceData=t.map(t=>Object.assign({},t)),this.sourceData.sort((t,i)=>i.value-t.value),this.options=Object.assign({},i),this.initRectInfo(),this.squarified(this.sourceData,[],this.getMinSide())}getSum(t){return 1===t.length?t[0].value:t.reduce((t,i)=>(t="object"===typeof t?t.value:t,i="object"===typeof i?i.value:i,(t||0)+(i||0)))}get heightWidthRatio(){return this.options.height/this.options.width}get widthScale(){return this.options.width/this.rectInfo.width}get heightScale(){return this.options.height/this.rectInfo.height}initRectInfo(){this.rectInfo={sx:0,sy:0,rows:[],total:this.getSum(this.sourceData)},this.rectInfo.width=Math.sqrt(this.rectInfo.total/this.heightWidthRatio),this.rectInfo.height=this.rectInfo.width*this.heightWidthRatio}squarified(t,i,e){if(!t.length)return this.newLayoutRow(i,e);let h=[...i,t[0]];!i.length||i.length&&this.worstNewRadio(i,t[0],e)>this.worstOldRadio(h,e)?(t.splice(0,1),this.squarified(t,h,e)):(this.newLayoutRow(i,e),this.squarified(t,[],this.getMinSide()))}worstOldRadio(t,i){let e=this.getSum(t)/i.value;return this.getMaxRatio(e,t[t.length-1].value/e)}worstNewRadio(t,i,e){let h=this.getSum(t)/e.value,s=Math.min(this.rectInfo.width-this.rectInfo.sx-(e.vertical?h:0),this.rectInfo.height-this.rectInfo.sy-(e.vertical?0:h));return this.getMaxRatio(s,i.value/s)}getMinSide(){let t=this.rectInfo.height-this.rectInfo.sy,i=this.rectInfo.width-this.rectInfo.sx;return t>i?{vertical:!1,value:i}:{vertical:!0,value:t}}newLayoutRow(t,i){let e=this.getSum(t)/i.value;t.forEach(t=>{let h=i.vertical?t.value/e:e,s=i.vertical?e:t.value/e,a={value:t.value,data:t,x:this.widthScale*this.rectInfo.sx,y:this.heightScale*this.rectInfo.sy,width:this.widthScale*s,height:this.heightScale*h};this.rectInfo.sy+=i.vertical?h:0,this.rectInfo.sx+=i.vertical?0:s,this.rectInfo.rows.push(a)}),i.vertical?(this.rectInfo.sy-=i.value,this.rectInfo.sx+=e):(this.rectInfo.sx-=i.value,this.rectInfo.sy+=e)}getMaxRatio(t,i){return Math.max(t/i,i/t)}}var o=a,r={data(){return{squarifiedRectInfo:[],colors:["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622"],data:[]}},mounted(){this.random(),this.$nextTick(()=>{this.init()}),window.addEventListener("resize",this.throttle(300,()=>{this.init()}))},methods:{random(){let t=[],i=Math.max(Math.round(15*Math.random()),10);for(let e=0;e<i;e++)t.push({value:Math.max(Math.round(1e3*Math.random()),50)});this.data=t,this.init()},throttle(t=0,i){let e=null;return()=>{e||(e=setTimeout(()=>{e=null,i()},t))}},init(){let t=new o(this.data,{width:this.$refs.container.offsetWidth,height:this.$refs.container.offsetHeight});this.squarifiedRectInfo=t.rectInfo.rows}}},n=r,c=(e("c913"),e("2877")),l=Object(c["a"])(n,h,s,!1,null,"d1d39252",null);i["default"]=l.exports},b422:function(t,i,e){},c913:function(t,i,e){"use strict";e("b422")}}]);